# Simple Implementation of GPT

## Description
This repository contains a simple implementation of a GPT model, which is a decoder-only transformer. It includes a small-scale text dataset generated by [chatGPT](https://openai.com/chatgpt/). The model can be trained to generate text based on this dataset. It supports both English and Japanese languages.

## Installation
Run the following command to install the required packages:
```bash
pip install -r requirements.txt
```
The `datas.zip` file also contains the processed corpus data, so there's no need to run `make_corpus.py`. 
If you wish to use additional text data, refer to `make_corpus.py` to consider integrating new text data. In this case, make sure to append new tokens to token_to_id in `assets.yaml` rather than creating a new dictionary.

## Usage
### Training
To train the model, use the following command:
```bash
python train.py --data_path ./sample_jpn.npy --language jpn
```
Set the `--data_path` option to specify the dataset path. The `--language` option should correspond to the dataset language.

Since this is a simple implementation, there is no learning rate scheduling. 
Adjust `batch_size`, `seq_len`, and `n_layer` in `GPTConfig` according to your machine's capabilities.
There are various ways to create a dataset. In `train.py`, all words are specified as the initial words, but this method is very inefficient for large-scale datasets.

## Generation
To generate text using a trained model, run:
```bash
python generate.py --input_text "I want" --load_weights_folder ./weights/eng/3/ --language eng
```
You can specify the input_text option to provide the prompt for text generation.

## Results
The following are some sample outputs generated using the trained model. 
Note that the outputs are probabilistic and may closely reflect sentences found in the dataset. By using a larger dataset, the model's generalization ability can be improved.

### English
```
usa swaying in the river flow , the clear stream flows slowly , and pebbles and sand at the bottom of the river can be seen through. the surface of the water is lightly waved , and the sound of occasional fish bounces above it. the surrounding grass and trees grow on the waterside of the river , and the reflection is calm and relaxed. you can feel the natural ecosystem in harmony.
q : where is the highest waterfall in the world ? a : the highest waterfall in the world is angelfall , in venezuela. the depth is about 3 , 212 meters ( 10 , 536 feet ).
" thank you. "
baroque music is made of acceleration expansion of the universe that flourished in the world.
future relationships can deepen through digital technology.
good acts should not be forced , but voluntary.
he has launched his long - awaited business and provides products that will be pleased by many people.
his heart was spread like a flower blooming in the warmth of spring night. i felt a soft scent , and i felt that new emotions and hope were sprouting in my heart. the quietness of the night enhanced its beauty.
his heart was silence in the sky at dusk in autumn. the sky dyed by the sunset reflected the complex emotions of his heart , making it feel somewhat ephemeral. the sound of the leaves was quietly echoing in his heart.
future relationships can deepen through digital technology.
good is born from free act that does not require a reward , and it is worth it.
from the christmas season , the city is colored with illuminations and is wrapped in a gorgeous atmosphere.
q : what is the " cpu " of the computer ? a : the " cpu " of the computer stands for " central processing unit ". perform major calculation processing of computers.
" please submit the progress report of the project by the end of the month. "
ecological footprint is an indicator of individuals and community environments. you need to review your lifestyle and reduce the burden on the environment.
you taught had a big impact on my life.
by doing good , you can enrich your own heart.
q : what conditioning are the scientific research on the possibility of " extraterrestrial life forms " ? a : scientific research on the possibility of " extraterrestrial life forms " is called " seti ".
we held a solo exhibition in the long - awaited art gallery , and many people saw our work.
international cooperation and diplomatic efforts are important to prevent the outbreak of war.
```
### Japanese
```
春の到来と共に、街中のカフェのテラス席が人気となり、外でのひとときを楽しむ人々で賑わう。
チョコレートパフェの層には、チョコレートアイスクリーム、ブラウニー、ホイップクリームが重なり、贅沢な味わいを楽しめる。
私は楽しいことを見つけるのが得意で、日常生活に喜びをもたらすことができる。
山道を歩くと、秋の木々が放つ香りとともに、心地よいひんやりとした風が吹いてくる。
「更新手続きはオンラインで完了できます。」
「クライアントからの反応は非常に好意的です。」
善は時には困難な選択を伴うが、その選択が成長の機会となる。
芸術は、昔ながらの手作りの看板と古い店舗が並んでいる。
紅茶とサンドイッチの組み合わせは、午後のティータイムにぴったりだ。
未来の都市には、スマートシティとして効率的で環境に優しい設計がされるだろう。
彼の心は、夏の夜に咲く花火のように、瞬間的に鮮やかで、感情の爆発があった。花火が夜空に輝くように、彼の感情もまた、時折強く輝きを放っていた。
フルーツやブランチに挟んだ滋養たっぷりのスープで、甘い味わいが楽しめる。
小さな成功を狙って、座るのにはれている。
Q:シェイクスピアの劇の中で「ロミオとジュリエット」はどのようなストーリーですか?A:「ロミオとジュリエット」は、2つの敵対する家族の間で禁じられた恋に落ちる若いカップルの物語です。悲劇的な運命により、最終的には2人は共に命を落とすことになります。Q:太陽系の惑星の中で最も大きいのはどれですか?A:太陽系の惑星の中で最も大きいのは木星です。木星の直径は約139,820キロメートルで、他の惑星を大きく上回ります。
汚い言動は他者との関係に悪影響を及ぼす可能性がある。
飼い猫のモモは、人々に可愛がられて新しい家を見つける。
中東のひよこ豆のペーストで、クリーミーで濃厚な味わいがパンや野菜とよく合います。
使用済みの提案手法は、とても助かりました!」
善の行為は、無理に求めるものではなく、自発的なものであるべきだ。
紅茶の葉をじっくりと蒸らすことで、深い味わいが引き出される。
```

## References
Code:
- [minGPT](https://github.com/karpathy/minGPT)
